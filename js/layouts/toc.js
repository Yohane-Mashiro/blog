function initTOC(){Global.utils.navItems=document.querySelectorAll(".post-toc-wrap .post-toc li");if(Global.utils.navItems.length>0){Global.utils={...Global.utils,updateActiveTOCLink(){if(!Array.isArray(Global.utils.sections))return;let t=Global.utils.sections.findIndex((t=>t&&t.getBoundingClientRect().top-200>0));if(t===-1){t=Global.utils.sections.length-1}else if(t>0){t--}this.activateTOCLink(t)},registerTOCScroll(){Global.utils.sections=[...document.querySelectorAll(".post-toc li a.nav-link")].map((t=>{const e=document.getElementById(decodeURI(t.getAttribute("href")).replace("#",""));t.addEventListener("click",(t=>{t.preventDefault();const o=e.getBoundingClientRect().top+window.scrollY;window.anime({targets:document.scrollingElement,duration:500,easing:"linear",scrollTop:o-10,complete:function(){setTimeout((()=>{Global.utils.pageTop_dom.classList.add("hide")}),100)}})}));return e}))},activateTOCLink(t){const e=document.querySelectorAll(".post-toc li a.nav-link")[t];if(!e||e.classList.contains("active-current")){return}document.querySelectorAll(".post-toc .active").forEach((t=>{t.classList.remove("active","active-current")}));e.classList.add("active","active-current");const o=document.querySelector(".toc-content-container");const l=o.getBoundingClientRect();const i=e.getBoundingClientRect();const n=o.offsetHeight>window.innerHeight?(o.offsetHeight-window.innerHeight)/2:0;const s=i.top-l.top+o.scrollTop;const c=s-n+i.height/2;const a=l.top+l.height/2;const r=c-a;window.anime({targets:o,duration:400,easing:"easeOutQuad",scrollTop:o.scrollTop+r})},showTOCAside(){const t=()=>{const t=Global.getStyleStatus();const e="isOpenPageAside";if(t&&t.hasOwnProperty(e)){Global.utils.TocToggle.pageAsideHandleOfTOC(t[e])}else{Global.utils.TocToggle.pageAsideHandleOfTOC(true)}};const e="init_open";if(Global.theme_config.articles.toc.hasOwnProperty(e)){Global.theme_config.articles.toc[e]?t():Global.utils.TocToggle.pageAsideHandleOfTOC(false)}else{t()}}};Global.utils.showTOCAside();Global.utils.registerTOCScroll()}else{document.querySelectorAll(".toc-content-container, .toc-marker").forEach((t=>{t.remove()}))}}if(Global.theme_config.global.pjax===true&&Global.utils){initTOC()}else{window.addEventListener("DOMContentLoaded",initTOC)}